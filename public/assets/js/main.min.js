$(async function(){$(window).on("resize.vh",function(){var e=.01*window.innerHeight;$("html").css("--vh",e+"px")}).trigger("resize.vh");const t=document.querySelector("[data-camera-video]"),l=document.querySelector("[data-camera-canvas]"),u=l.getContext("2d");let n,w=!0,i,o;function e(){navigator.mediaDevices.getUserMedia({video:{facingMode:w?"user":"environment",width:{ideal:2400},height:{ideal:3200}}}).then(function(e){n=e,t.srcObject=e,i&&t.removeEventListener("loadeddata",i),i=function(){console.log("loadeddata"),l.width=t.videoWidth,l.height=t.videoHeight},t.addEventListener("loadeddata",i,!1);const g=new Image;g.src="./assets/image/touch/logo.png";const a=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});a.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),a.onResults(function(h){requestAnimationFrame(()=>{if(u.clearRect(0,0,l.width,l.height),u.save(),w&&(u.translate(l.width,0),u.scale(-1,1)),u.drawImage(h.image,0,0,l.width,l.height),h.multiFaceLandmarks)for(const e of h.multiFaceLandmarks)drawConnectors(u,e,FACEMESH_LIPS,{color:"#E0E0E0"});if(h.multiFaceLandmarks&&0<h.multiFaceLandmarks.length){var i=h.multiFaceLandmarks[0];let e=1/0,a=1/0,t=-1/0,n=-1/0;for(const m of i){var o=m.x*l.width,c=m.y*l.height;e=Math.min(e,o),a=Math.min(a,c),t=Math.max(t,o),n=Math.max(n,c)}var r=t-e,d=r*(n-a)/(window.innerWidth*window.innerHeight),s=i[10],i=s.x*l.width,s=s.y*l.height,d=r+10*d;u.drawImage(g,i-d/2,s-d,d,d)}u.restore()})}),o=new Camera(t,{onFrame:async()=>{await a.send({image:t})},width:3024,height:2400,facingMode:w?"user":"environment"}),o.start()}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}e(),$("[data-camera-direction]").on("click",function(){n.getTracks().forEach(e=>e.stop()),o&&o.stop(),w=!w,e()})});
//# sourceMappingURL=main.min.js.map
