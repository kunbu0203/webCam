$(function(){$(window).on("resize.vh",function(){var e=.01*window.innerHeight;$("html").css("--vh",e+"px")}).trigger("resize.vh");const a=document.querySelector("[data-camera-video]"),g=document.querySelector("[data-camera-canvas]"),l=g.getContext("2d");let n,w=!0,i,o;const u=new Image;u.src="./assets/image/touch/logo.png";let e=!(u.onload=()=>{c()}),t=!1,r=0,d=0;function c(){t=!1,e=!1,navigator.mediaDevices.getUserMedia({video:{facingMode:w?"user":"environment",width:{ideal:2400},height:{ideal:3200}}}).then(async function(e){n=e,a.srcObject=e,i&&a.removeEventListener("loadeddata",i);new Promise((e,t)=>{i=function(){g.width=a.videoWidth,g.height=a.videoHeight,r=a.videoWidth,d=a.videoHeight,e()},a.addEventListener("loadeddata",i,!1)});await 0;const t=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});t.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),t.onResults(function(m){requestAnimationFrame(()=>{if(l.clearRect(0,0,g.width,g.height),l.save(),w&&(l.translate(g.width,0),l.scale(-1,1)),l.drawImage(m.image,0,0,g.width,g.height),m.multiFaceLandmarks)for(const e of m.multiFaceLandmarks)drawConnectors(l,e,FACEMESH_LIPS,{color:"#E0E0E0"});if(m.multiFaceLandmarks&&0<m.multiFaceLandmarks.length){var i=m.multiFaceLandmarks[0];let e=1/0,t=1/0,a=-1/0,n=-1/0;for(const h of i){var o=h.x*g.width,r=h.y*g.height;e=Math.min(e,o),t=Math.min(t,r),a=Math.max(a,o),n=Math.max(n,r)}var d=a-e,c=d*(n-t)/(window.innerWidth*window.innerHeight),s=i[10],i=s.x*g.width,s=s.y*g.height,c=d+10*c;l.drawImage(u,i-c/2,s-c,c,c)}l.restore()})}),$(".text").append(`<br>${r}, ${d}`),o=new Camera(a,{onFrame:async()=>{await t.send({image:a})},width:r,height:d,facingMode:w?"user":"environment"}),o.start()}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}$("[data-camera-direction]").on("click",function(){o&&o.stop(),n.getTracks().forEach(e=>e.stop()),w=!w,c()})});
//# sourceMappingURL=main.min.js.map
