$(function(){$(window).on("resize.vh",function(){var e=.01*window.innerHeight;$("html").css("--vh",e+"px")}).trigger("resize.vh");!function n(p){console.log(p);let i;let o;const r=document.querySelector(`[data-camera-video="${p}"]`);const F=document.querySelector(`[data-camera-canvas="${p}"]`);const k=F.getContext("2d");let c;let d=!1;let s=!1;navigator.mediaDevices.getUserMedia({video:{facingMode:p,width:{ideal:2400},height:{ideal:3200}}}).then(async function(e){i=e,r.srcObject=e,c&&r.removeEventListener("loadeddata",c);var e=new Promise((e,t)=>{c=function(){F.width=r.videoWidth,F.height=r.videoHeight,e()},r.addEventListener("loadeddata",c,!1)});await e;const v=new Image;v.src="./assets/image/touch/logo.png";const t=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});function a(f){requestAnimationFrame(()=>{if(k.clearRect(0,0,F.width,F.height),k.save(),"user"===p&&(k.translate(F.width,0),k.scale(-1,1)),k.drawImage(f.image,0,0,F.width,F.height),f.multiFaceLandmarks)for(const e of f.multiFaceLandmarks)drawConnectors(k,e,FACEMESH_LIPS,{color:"#E0E0E0"});if(f.multiFaceLandmarks&&0<f.multiFaceLandmarks.length){var i=f.multiFaceLandmarks[0];let e=1/0,t=1/0,a=-1/0,n=-1/0;for(const w of i){var o=w.x*F.width,r=w.y*F.height;e=Math.min(e,o),t=Math.min(t,r),a=Math.max(a,o),n=Math.max(n,r)}var c=a-e,d=n-t,s=c*d,m=s/(window.innerWidth*window.innerHeight),h=i[10],l=h.x*F.width,g=h.y*F.height,u=c+10*m;k.drawImage(v,l-u/2,g-u,u,u)}k.restore()})}t.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),t.onResults(a),o=new Camera(r,{onFrame:async()=>{await t.send({image:r}),d||(d=!0,$(".text").append("<br>frameReady")),d&&s},width:r.videoWidth,height:r.videoHeight,facingMode:p}),o.start(),s||(s=!0,$(".text").append("<br>cameraStart")),d&&s,$(`[data-camera-direction="${p}"]`).off("click.direction").on("click.direction",function(){i.getTracks().forEach(e=>e.stop()),o&&o.stop(),console.log(p),n("user"===p?"environment":"user")})}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}("user")});
//# sourceMappingURL=main.min.js.map
