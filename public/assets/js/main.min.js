$(async function(){$(window).on("resize.vh",function(){var e=.01*window.innerHeight;$("html").css("--vh",e+"px")}).trigger("resize.vh");const t=document.querySelector("[data-camera-video]"),g=document.querySelector("[data-camera-canvas]"),l=g.getContext("2d");let i,v=!0,n,o;const u=new Image;function e(){navigator.mediaDevices.getUserMedia({video:{facingMode:v?"user":"environment",width:{ideal:2400},height:{ideal:3200}}}).then(function(e){i=e,t.srcObject=e,n&&t.removeEventListener("loadeddata",n),n=function(){g.width=t.videoWidth,g.height=t.videoHeight,$(".camera-loading").addClass("hide")},t.addEventListener("loadeddata",n,!1);const a=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});a.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),a.onResults(function(m){requestAnimationFrame(()=>{if(l.clearRect(0,0,g.width,g.height),l.save(),v&&(l.translate(g.width,0),l.scale(-1,1)),l.drawImage(m.image,0,0,g.width,g.height),m.multiFaceLandmarks)for(const e of m.multiFaceLandmarks)drawConnectors(l,e,FACEMESH_LIPS,{color:"#E0E0E0"});if(m.multiFaceLandmarks&&0<m.multiFaceLandmarks.length){var n=m.multiFaceLandmarks[0];let e=1/0,a=1/0,t=-1/0,i=-1/0;for(const h of n){var o=h.x*g.width,d=h.y*g.height;e=Math.min(e,o),a=Math.min(a,d),t=Math.max(t,o),i=Math.max(i,d)}var r=t-e,c=r*(i-a)/(window.innerWidth*window.innerHeight),s=n[10],n=s.x*g.width,s=s.y*g.height,c=r+10*c;l.drawImage(u,n-c/2,s-c,c,c)}l.restore()})}),o=new Camera(t,{onFrame:async()=>{await a.send({image:t})},width:t.videoWidth,height:t.videoHeight,facingMode:v?"user":"environment"}),o.start()}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}u.src="./assets/image/touch/logo.png",u.onload=()=>{e()},$("[data-camera-direction]").on("click",function(){$(".camera-loading").removeClass("hide"),i.getTracks().forEach(e=>e.stop()),o&&o.stop(),v=!v,e()})});
//# sourceMappingURL=main.min.js.map
