$(async function(){$(window).on("resize.vh",function(){var e=.01*window.innerHeight;$("html").css("--vh",e+"px")}).trigger("resize.vh");const i=document.querySelector("[data-camera-video]"),g=document.querySelector("[data-camera-canvas]"),w=g.getContext("2d");let t,e=!0,n;function a(){navigator.mediaDevices.getUserMedia({video:{facingMode:e?"user":"environment",width:{ideal:2400},height:{ideal:3200}}}).then(function(e){t=e,i.srcObject=e}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}a();new Promise((e,t)=>{i.addEventListener("play",function(){g.width=i.videoWidth,g.height=i.videoHeight,e()},!1)});await 0,$("[data-camera-direction]").on("click",function(){t.getTracks().forEach(e=>e.stop()),e=!e,a(),n&&(n.stop(),n=void 0),c()});const l=new Image;l.src="./assets/image/touch/logo.png";const o=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});function c(){n=new Camera(i,{onFrame:async()=>{await o.send({image:i})},width:i.videoWidth,height:i.videoHeight,facingMode:e?"user":"environment"}),n.start()}o.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),o.onResults(function(m){requestAnimationFrame(()=>{if(w.clearRect(0,0,g.width,g.height),w.save(),e&&(w.translate(g.width,0),w.scale(-1,1)),w.drawImage(m.image,0,0,g.width,g.height),m.multiFaceLandmarks&&0<m.multiFaceLandmarks.length){var a=m.multiFaceLandmarks[0];let e=1/0,t=1/0,i=-1/0,n=-1/0;for(const h of a){var o=h.x*g.width,c=h.y*g.height;e=Math.min(e,o),t=Math.min(t,c),i=Math.max(i,o),n=Math.max(n,c)}var r=i-e,d=r*(n-t)/(window.innerWidth*window.innerHeight),s=a[10],a=s.x*g.width,s=s.y*g.height,d=r+10*d;w.drawImage(l,a-d/2,s-d,d,d)}w.restore()})}),c()});
//# sourceMappingURL=main.min.js.map
